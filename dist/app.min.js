"use strict";!function(){angular.module("angular-json-server",[])}(),function(){angular.module("angular-json-server").factory("CRUDResourceFactory",function(n,t){function e(n,t,e){var o=this;this.crudService=n,this.vm=t,this.options=angular.extend({},r,e),this.vm.currentPage=0;var a=e.watcher;a&&a.scope&&a.scope.$watch(function(){return a.expression?o.vm[a.expression]:o.vm.query},function(n,t){a.customLoadFunction?a.customLoadFunction(n):a.loadOne?o.loadOne(n):o.load(n)},!0)}function o(n,t,o){if(!n||!t)throw new Error("createInstance missing required parameters");return new e(n,t,o)}var r={pageSize:10,resourceName:"resource",instanceName:"instance"};return e.prototype.load=function(n){var e=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.options.pageSize;return this.vm.loading=!0,n=angular.extend({},this.options.query,n),this.vm.loadedAll=!1,this.crudService.find(n,{page:o,pageSize:r}).then(function(a){if(n.union){var i=e.vm[e.options.resourceName];e.vm[e.options.resourceName]=t.union(i,a.data)}else e.vm[e.options.resourceName]=a.data,e.vm.currentPage=0;var u=a.headers("X-Total-Count");return u&&o*r+r>=u&&(e.vm.loadedAll=!0),e.options.onLoad&&e.options.onLoad(a.data),a.data},function(n){return e.vm.loadingError=!0,e.options.onLoadError&&e.options.onLoadError(n),n}).finally(function(){e.vm.loading=!1})},e.prototype.loadMore=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.pageSize;if(n=angular.extend({},n,{union:!0}),this.vm.currentPage=this.vm.currentPage||0,this.vm.currentPage++,this.vm.loadedAll)throw new Error("There are no more resources to load.");return this.load(n,this.vm.currentPage,t)},e.prototype.loadOne=function(t){var e=this;return this.vm.loading=!0,n(function(n,o){e.crudService.findOne(t).then(function(t){return e.vm[e.options.instanceName]=t,e.options.onLoad&&e.options.onLoad(t),n(t),t},function(n){return e.vm.loadingError=!0,e.options.onLoadError&&e.options.onLoadError(n),n}).finally(function(){e.vm.loading=!1})})},{createInstance:o}})}(),function(){angular.module("angular-json-server").factory("CRUDServiceFactory",function(n,t,e,o){function r(n){this.resourcePath=n}function a(n){if(!n)throw new Error("resourcePath missing on CRUDServiceFactory");return new r(n)}return r.prototype.find=function(r,a){var i=this;r=angular.extend({},r),a=angular.extend({page:t.FIND.DEFAULT_PAGE,pageSize:t.FIND.DEFAULT_PAGE_SIZE},a);var u={q:r.textSearch,_start:a.page*a.pageSize,_limit:a.pageSize};return e(function(t,e){o.get(n+i.resourcePath,{params:u}).then(function(n){t(n)},function(n){e(n.data)})})},r.prototype.findOne=function(t){var r=this;return e(function(e,a){o.get(""+n+r.resourcePath+"/"+t).then(function(n){e(n.data)},function(n){return a(n.data)})})},r.prototype.put=function(t){var r=this;return t=angular.extend({},t),e(function(e,a){o.put(n+r.resourcePath,t).then(function(n){e(n.data)},function(n){a(n.data)})})},r.prototype.destroy=function(t){var r=this;return e(function(e,a){o.delete(n+r.resourcePath+"/"+t).then(function(n){e(n.data)},function(n){a(n.data)})})},{createInstance:a}})}();